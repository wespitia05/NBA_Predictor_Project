<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Predictor Project Game Page</title>
    <!-- link to the css file in static folder -->
    <link rel="stylesheet" href="{{url_for('static', filename='game_page.css')}}">
    <!-- link to the js file in the static folder -->
    <script src="{{url_for('static', filename='game_page.js')}}"></script>
</head>
<body>
    <header>
        <div class="team-logo">
            <img src="{{ url_for('static', filename=away_logo) }}" alt="{{ away_name }} logo">
        </div>
        <!-- wrap title in container -->
        <div class="header-text">
            <!-- page title -->
            <h1>{{ away_name }} @ {{ home_name }}</h1>
            <p>{{ date_et }} {{ time_et_text }}</p>
            <p>{{ notes }}</p>
        </div>
        <div class="team-logo">
            <img src="{{ url_for('static', filename=home_logo) }}" alt="{{ home_name }} logo">
        </div>
    </header>

    <section class="team-vs-opp">
        <h3>Team Performance Against Opponent</h3>
        <p>Based on data from 2023-2025</p>
        <table>
            <thead>
                <tr>
                    <th>Game Date</th>
                    <th>Matchup</th>
                    <th>Season Type</th>
                    <th>Points</th>
                    <th>Rebounds</th>
                    <th>Assists</th>
                    <th>Turnovers</th>
                    <th>Win</th>
                </tr>
            </thead>
            <tbody>
                {% for g in last5_h2h %}
                <tr>
                    <td>{{ g["Game Date"] }}</td>
                    <td>{{ g["Matchup"] }}</td>
                    <td>{{ g["Season Type"] }}</td>
                    <td>{{ g["Points"] }}</td>
                    <td>{{ g["Rebounds"] }}</td>
                    <td>{{ g["Assists"] }}</td>
                    <td>{{ g["Turnovers"] }}</td>
                    <td>{{ 'Yes' if g["Win"] == 1 else 'No' if g["Win"] == 0 else '' }}</td>
                </tr>
                {% endfor %}
                {% if not last5_h2h %}
                <tr>
                    <td colspan="8">
                        <em>No recent games found.</em>
                    </td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </section>

    <!-- Prediction UI -->
    <section id="predict-section"
            class="predict-section"
            data-game-id="{{ game_id }}"
            data-home-name="{{ home_name }}"
            data-away-name="{{ away_name }}">
        <button id="predict-btn" class="predict-btn" type="button">
            Calculate Win Probability
        </button>

        <div id="predict-error" class="predict-error hidden" role="alert"></div>

        <div id="predict-results" class="predict-results hidden" aria-live="polite">
            <h3 class="predict-title">Match Prediction:</h3>

            <!-- with this: -->
            <table class="prob-table" aria-label="Win probability table">
                <thead>
                    <tr>
                        <th>Team</th>
                        <th>Win Probability</th>
                    </tr>
                </thead>
                <tbody id="pred-table-body">
                <!-- JS will insert rows -->
                </tbody>
            </table>

            <p id="pred-accuracy" class="pred-accuracy"></p>

            <details class="pred-details">
                <summary>Why This Prediction?</summary>
                <div id="pred-explain" class="pred-explain"></div>
            </details>
        </div>

        <div id="predict-loading" class="predict-loading hidden" aria-hidden="true">
            Calculatingâ€¦
        </div>
    </section>
    
    <!-- footer -->
    <footer>
        <p>&copy; 2025 Courtside Predictor - Built with Flask</p>
    </footer>
</body>
</html>